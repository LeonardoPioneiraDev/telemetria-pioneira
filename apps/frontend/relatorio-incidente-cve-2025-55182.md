# Relatório de Incidente de Segurança

## CVE-2025-55182 - Vulnerabilidade Crítica em React Server Components

---

### 1. Resumo Executivo

Em **06 de dezembro de 2025**, foi identificada atividade maliciosa em múltiplas aplicações frontend da organização. Após investigação, constatou-se que as aplicações estavam sendo alvo de tentativas de exploração da vulnerabilidade **CVE-2025-55182**, uma falha crítica de execução remota de código (RCE) no React Server Components.

Todas as tentativas de invasão foram **bloqueadas** devido às configurações de segurança dos containers. Medidas corretivas foram implementadas imediatamente, incluindo atualização de todas as aplicações vulneráveis e rotação de credenciais.

---

### 2. Sobre a Vulnerabilidade

#### 2.1 Identificação

| Campo | Valor |
|-------|-------|
| **CVE** | CVE-2025-55182 |
| **Severidade** | Crítica |
| **Tipo** | Remote Code Execution (RCE) |
| **Componente Afetado** | React Server Components (pacote `react-server-dom`) |
| **Causa Raiz** | Deserialização insegura no protocolo RSC "Flight" |

#### 2.2 Descrição Técnica

A vulnerabilidade está presente no **núcleo do React**, especificamente no pacote `react-server-dom` que implementa o protocolo "Flight" para React Server Components.

### ATENÇÃO: Next.js E Vite são AMBOS vulneráveis

**Esta vulnerabilidade NÃO afeta apenas o Next.js.** Aplicações construídas com **Vite, Parcel, React Router e outros frameworks também estão vulneráveis** se utilizarem React 19.x em versões não corrigidas.

A falha está no **React em si**, não no framework. Portanto:

| Framework | Vulnerável? | Ação Necessária |
|-----------|-------------|-----------------|
| Next.js + React 19.x | **SIM** | Atualizar Next.js e React |
| Vite + React 19.x | **SIM** | Atualizar React |
| Parcel + React 19.x | **SIM** | Atualizar React |
| Create React App + React 19.x | **SIM** | Atualizar React |
| Qualquer app com React 19.x | **SIM** | Atualizar React |

A falha permite que atacantes enviem requisições HTTP especialmente crafted para explorar uma deserialização insegura. Quando explorada com sucesso, permite execução arbitrária de código no servidor, sem necessidade de autenticação.

**Características do ataque:**
- Não requer autenticação
- Baixa complexidade de exploração
- Taxa de sucesso próxima a 100%
- **Afeta QUALQUER aplicação React 19.x** (Next.js, Vite, Parcel, etc.)
- Exploração ativa iniciada em 05 de dezembro de 2025

#### 2.3 Frameworks e Versões Afetadas

**React (componente principal da vulnerabilidade):**

| Versões Vulneráveis | Versões Corrigidas |
|---------------------|-------------------|
| 19.0.0 | 19.0.1 |
| 19.1.0, 19.1.1 | 19.1.2 |
| 19.2.0 | 19.2.1 |

**Frameworks que utilizam React Server Components (todos potencialmente afetados):**

| Framework | Versões Vulneráveis | Versões Corrigidas |
|-----------|---------------------|-------------------|
| Next.js (App Router) | 15.0.x até 15.5.6, 16.0.x | 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7 |
| Vite RSC Plugin | Versões com React vulnerável | Atualizar React para versão corrigida |
| Parcel RSC Plugin | Versões com React vulnerável | Atualizar React para versão corrigida |
| React Router RSC | Versões com React vulnerável | Atualizar React para versão corrigida |
| Waku | Versões com React vulnerável | Atualizar React para versão corrigida |
| RedwoodJS | Versões com React vulnerável | Atualizar React para versão corrigida |

**Importante:** Mesmo aplicações que não utilizam Server Components diretamente devem atualizar o React como medida preventiva, pois futuras integrações ou dependências podem introduzir o vetor de ataque.

#### 2.4 Fonte da Informação

**Wiz Security Research**
Artigo: *"Critical Vulnerability in React - CVE-2025-55182"*
URL: https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182
Data de publicação: 06 de dezembro de 2025

---

### 3. Aplicações Afetadas e Tentativas de Invasão

#### 3.1 Sistemas Identificados

Foram identificadas tentativas de exploração nos seguintes sistemas:

| Sistema | Framework | Versão React Anterior | Status da Tentativa |
|---------|-----------|----------------------|---------------------|
| Telemetria Frontend | Next.js 15.5.4 | React 19.1.0 | Bloqueada |
| Sistema de Premiação | Next.js 15.3.1 | React 19.0.0 | Bloqueada |
| Contracheque Web | Next.js 15.3.2 | React 19.0.0 | Bloqueada |
| Sistema de Trocas | Next.js 15.3.0 | React 19.0.0 | Bloqueada |
| CCO Frontend | Vite + React | React 19.1.0 | Bloqueada |

**Nota:** Todas as aplicações React, independentemente do framework utilizado (Next.js, Vite, etc.), foram consideradas potencialmente vulneráveis e atualizadas como medida de segurança.

#### 3.2 Indicadores de Comprometimento (IOCs) Detectados

Durante a análise dos logs, foram identificados os seguintes indicadores de atividade maliciosa:

**IPs de origem dos ataques:**
- `193.34.213.150`
- `217.60.249.228`
- `45.134.174.235`
- `194.69.203.32`
- `176.117.107.154`
- `47.89.149.53`
- `85.11.167.3`

**Padrões de ataque observados:**
- Tentativas de download de binários maliciosos
- Tentativas de execução de scripts remotos
- Scanning de endpoints internos do Next.js
- Tentativas de estabelecer conexões reversas

#### 3.3 Por que as tentativas foram bloqueadas

As tentativas de invasão não foram bem-sucedidas devido às seguintes medidas de segurança já implementadas nos containers:

1. **Imagens Docker minimalistas (Alpine Linux)** - Ausência de ferramentas como `bash`, `wget`, `curl` completos
2. **Princípio do menor privilégio** - Containers executando com usuário não-root
3. **Sistema de arquivos restrito** - Permissões de escrita limitadas
4. **Isolamento de rede** - Containers em redes Docker isoladas

---

### 4. Medidas Corretivas Implementadas

#### 4.1 Atualização das Aplicações

Todas as aplicações vulneráveis foram atualizadas para versões corrigidas:

| Sistema | Framework | Versão React Corrigida | Status |
|---------|-----------|------------------------|--------|
| Telemetria Frontend | Next.js 15.5.7 | React 19.1.2 | Corrigido |
| Sistema de Premiação | Next.js 15.3.6 | React 19.0.1 | Corrigido |
| Contracheque Web | Next.js 15.3.6 | React 19.2.1 | Corrigido |
| Sistema de Trocas | Next.js 15.3.6 | React 19.0.1 | Corrigido |
| CCO Frontend | Vite + React | React 19.1.2 | Corrigido |

**Todas as aplicações foram atualizadas para versões do React que contêm a correção de segurança.**

#### 4.2 Rotação de Credenciais

Como medida preventiva adicional, foram rotacionadas todas as credenciais de todos os sistemas:

- Senhas de bancos de dados PostgreSQL
- Secrets JWT de autenticação
- Tokens de API
- Demais credenciais de acesso

#### 4.3 Rebuild e Redeploy

Todos os containers foram reconstruídos a partir de imagens limpas:

1. Containers antigos foram removidos completamente
2. Imagens Docker antigas foram deletadas
3. Novas imagens foram construídas com código atualizado
4. Deploy realizado com verificação de versões

---

### 5. Verificação Pós-Correção

Após as correções, foi verificado em cada sistema em produção:

```
Next.js 15.3.6+ ou 15.5.7 (versões seguras)
React 19.0.1+ ou 19.1.2+ ou 19.2.1 (versões seguras)
Logs limpos sem atividade maliciosa
Serviços funcionando normalmente
```

--- 

### 6. Conclusão

A vulnerabilidade CVE-2025-55182 representa uma ameaça crítica para aplicações que utilizam React Server Components. Graças às configurações de segurança existentes nos containers, todas as tentativas de exploração foram bloqueadas antes de causar danos.

As medidas corretivas foram implementadas com sucesso em todas as aplicações afetadas, incluindo atualização de dependências e rotação preventiva de credenciais. Os sistemas estão agora protegidos contra esta vulnerabilidade específica.

Recomenda-se manter vigilância contínua e implementar as melhorias de segurança sugeridas para fortalecer a postura de segurança da organização.

---

**Elaborado por:** Felipe Batista

**Data:** 06 de dezembro de 2025

**Classificação:** Interno
